import{a as b,r as m,j as e,L as v,t as h}from"./index-DJUZKzu_.js";import{B as D}from"./button-CAINd3Jp.js";import{C as i,c as d,a as u,b as p}from"./card-DLOJ-z9V.js";import{C as L}from"./calendar-a2GBqBfK.js";import{U as C}from"./users-Bp_A7Hf7.js";const I=()=>{const{token:c}=b(),[l,f]=m.useState([]),[j,g]=m.useState(!0);m.useEffect(()=>{(async()=>{if(!c){h.error("Authentication required");return}try{const a=await fetch("http://localhost:8080/api/admin/leaves",{headers:{Authorization:`Bearer ${c}`}});if(!a.ok)throw new Error("Failed to fetch team leaves");const s=await a.json(),n=await Promise.all(s.map(async t=>{try{const o=await fetch(`http://localhost:8080/api/users/${t.userId}`,{headers:{Authorization:`Bearer ${c}`}});if(o.ok){const w=await o.json();return{...t,user:w}}else return console.error(`Failed to fetch user data for ID: ${t.userId}`),t}catch(o){return console.error(`Error fetching user data for ID: ${t.userId}`,o),t}}));f(n)}catch(a){console.error("Error fetching team leaves:",a),h.error("Failed to fetch team calendar data")}finally{g(!1)}})()},[c]);const N=r=>{switch(r.toLowerCase()){case"approved":return"bg-green-100 text-green-600";case"pending":return"bg-yellow-100 text-yellow-600";case"rejected":return"bg-red-100 text-red-600";default:return"bg-gray-100 text-gray-600"}},x=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),y=(r=>{const a=r.reduce((s,n)=>{const o=new Date(n.startDate).toLocaleString("en-US",{month:"long",year:"numeric"});return s[o]||(s[o]=[]),s[o].push(n),s},{});return Object.keys(a).forEach(s=>{a[s].sort((n,t)=>new Date(n.startDate).getTime()-new Date(t.startDate).getTime())}),a})(l);return e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Team Calendar"}),e.jsx(v,{to:"/dashboard",children:e.jsx(D,{variant:"outline",children:"Back to Dashboard"})})]}),e.jsx("div",{className:"space-y-6",children:j?e.jsx(i,{children:e.jsx(d,{className:"p-6",children:e.jsx("div",{className:"text-center",children:"Loading team calendar..."})})}):l.length===0?e.jsx(i,{children:e.jsx(d,{className:"p-6",children:e.jsx("div",{className:"text-center text-gray-500",children:"No leave requests found"})})}):Object.entries(y).map(([r,a])=>e.jsxs(i,{children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-lg font-medium",children:r}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[(()=>{var t;let n;return(t=s.user)!=null&&t.name?n=s.user.name:n=s.userId,e.jsx("p",{className:"font-medium",children:n})})(),e.jsxs("p",{className:"text-sm text-gray-500",children:[x(s.startDate)," - ",x(s.endDate)]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s.leaveType}),s.reason&&e.jsx("p",{className:"text-sm text-gray-500",children:s.reason})]})]})}),e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${N(s.status)}`,children:s.status.toUpperCase()})]},s.id))})})]},r))}),e.jsxs(i,{className:"mt-6",children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Statistics"}),e.jsx(C,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Leaves"}),e.jsx("p",{className:"text-2xl font-bold",children:l.length})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Approved Leaves"}),e.jsx("p",{className:"text-2xl font-bold",children:l.filter(r=>r.status.toLowerCase()==="approved").length})]})]})})]})]})})};export{I as default};
//# sourceMappingURL=TeamCalendar-E06zXzgk.js.map
